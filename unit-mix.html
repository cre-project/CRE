<!DOCTYPE HTML>
<html>
	<head>
		<title></title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
		<link rel="stylesheet" href="my.css" />
	</head>
	<body>
		<header>
            <div class="header-image"  id="logo-small" onclick="location.href='index.html';">
                <img class="header-image" src="t-logo-small.png" alt="Your logo here" />
            </div>
			<div id="menu">
                <div id="label">BETA</div>
                Marvin
				<div id="symbol">&#8964;</div>
                <div class="header-image" id="search">
                    <img class="header-image"  src="search-icon.png" alt="Seach" />
                </div>
			</div> 
		</header>
		<header id="sub-header">
			<nav>
				<ul>
					<li><a href="property-info.html">PROPERTY INFO</a></li>
					<li id="selected"><a>UNIT MIX</a></li>
					<li><a href="operating-statement.html">OPERATING STATEMENT</a></li>
					<li><a href="sales-comparables.html">SALES COMPARABLES</a></li>
					<li><a href="rent-comparables.html">RENT COMPARABLES</a></li>
					<li><a href="preview.html">PREVIEW</a></li>
				</ul>
			</nav>
        </header>
        <div class="wrapper">
            <h1>Unit Mix</h1>
            <table>
                <thead>
                    <tr>
                        <th>Unit Type</th>
                        <th>Square Feet</th>
                        <th>Current Rent/Mo.</th>
                        <th>Potential Rent/Mo.</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="editable">
                        <td>
                            <select class="buttonize down-arrow">
                                <option>1 Bedroom & 1 Bathroom</option>
                                <option>1 Bedroom & 2 Bathroom</option>
                                <option>2 Bedroom & 1 Bathroom</option>
                            </select>
                        </td>
                        <td><input class="inline-edit" disabled value="3650"></td>
                        <td>$<input class="inline-edit" disabled value="2000"></td>
                        <td>$<input class="inline-edit" disabled value="3000"></td>
                    </tr>
                </tbody>
            </table>
            <div id="add-more">
                <div class="add-more-content" id="plus">+</div>
                <span class="add-more-content">Add Another Unit</span>
            </div>
            <button class="save" type="submit" onclick="location.href='operating-statement.html'">Save & Next</button>
        </div>
        <script>
            const addMore = document.getElementById('plus')
            const saveButton = document.querySelector('.save')
            const dropdown = document.querySelector('select')
            const table = document.getElementsByTagName('tbody')[0]
            // TODO fix for multiple rows
            const row = document.querySelector('.editable')

            addMore.addEventListener('click', function() {
                // saveButton.classList.add('hidden')
                // form.classList.remove('hidden')
                addNewRow()
            })

            dropdown.addEventListener('click', function(evt) {
                evt.stopPropagation()
            })

            row.addEventListener('click', function(evt) {
                if (evt.target.classList.contains('inline-edit')) return
                this.querySelectorAll('input').forEach(elem => elem.hasAttribute('disabled') ? elem.removeAttribute('disabled') : elem.setAttribute('disabled', ''))
            })

            function addNewRow() {
                const newRow = table.insertRow(table.rows.length);
                const cell1 = newRow.insertCell(0);
                const cell2 = newRow.insertCell(1);
                const cell3 = newRow.insertCell(2);
                const cell4 = newRow.insertCell(3);

                const dropdown = document.createElement('select') 
                const option1 = document.createElement('option') 
                const option2 = document.createElement('option') 
                const option3 = document.createElement('option') 

                const input2 = document.createElement('input')
                const input3 = document.createElement('input')
                const input4 = document.createElement('input')

                newRow.classList.add('editable')
                dropdown.classList.add('buttonize')
                dropdown.classList.add('down-arrow')

                option1.innerText = '1 Bedroom & 1 Bathroom'
                option2.innerText = '1 Bedroom & 2 Bathroom'
                option3.innerText = '2 Bedroom & 1 Bathroom'

                dropdown.appendChild(option1)
                dropdown.appendChild(option2)
                dropdown.appendChild(option3)
                
                input2.classList.add('inline-edit')
                input3.classList.add('inline-edit')
                input4.classList.add('inline-edit')

                cell3.innerText = '$';
                cell4.innerText = '$';

                cell1.appendChild(dropdown);
                cell2.appendChild(input2);
                cell3.appendChild(input3);
                cell4.appendChild(input4);
            }
        </script>
	</body>
</html>